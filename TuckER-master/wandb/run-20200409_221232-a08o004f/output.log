Training the TuckER model...
Number of training data points: 272115
Starting training...
Iteration:1
Training Time:18.30153489112854
Loss:0.0120297290257191
Validation:
Number of data points: 17535
Hits @10: 0.19788993441688052
Hits @3: 0.1341317365269461
Hits @1: 0.07482178500142572
Mean rank: 3345.927972626176
Mean reciprocal rank: 0.11678421436039087
Iteration:2
Training Time:15.743885040283203
Loss:0.002433361508405117
Validation:
Number of data points: 17535
Hits @10: 0.2448246364414029
Hits @3: 0.16629597946963218
Hits @1: 0.10362132877102936
Mean rank: 2781.026632449387
Mean reciprocal rank: 0.15172239751613023
Test:
Number of data points: 20466
Hits @10: 0.2446496628554676
Hits @3: 0.1673018665103098
Hits @1: 0.10353757451382781
Mean rank: 2879.0649369686307
Mean reciprocal rank: 0.15127278542788325
Testing time:20.019723415374756
Iteration:3
Training Time:15.713931798934937
Loss:0.0021922203677081286
Validation:
Number of data points: 17535
Hits @10: 0.27356715141146276
Hits @3: 0.17627601938979184
Hits @1: 0.09295694325634446
Mean rank: 2442.674707727402
Mean reciprocal rank: 0.15368246307925618
Iteration:4
Training Time:15.75984263420105
Loss:0.002103116523557381
Validation:
Number of data points: 17535
Hits @10: 0.32899914456800683
Hits @3: 0.2230396350156829
Hits @1: 0.14719133162246933
Mean rank: 1914.3714856002282
Mean reciprocal rank: 0.2055105096512888
Test:
Number of data points: 20466
Hits @10: 0.3241962278901593
Hits @3: 0.21772696179028633
Hits @1: 0.14614482556435063
Mean rank: 1999.282077592104
Mean reciprocal rank: 0.2026425330257906
Testing time:19.741191625595093
Iteration:5
Training Time:15.756850242614746
Loss:0.002029494451971291
Validation:
Number of data points: 17535
Hits @10: 0.3678927858568577
Hits @3: 0.2615340747077274
Hits @1: 0.17986883376104934
Mean rank: 1532.9750213858
Mean reciprocal rank: 0.2416578928097925
Iteration:6
Training Time:15.726930379867554
Loss:0.001954944048249099
Validation:
Number of data points: 17535
Hits @10: 0.40085543199315654
Hits @3: 0.2889078984887368
Hits @1: 0.19657827202737382
Mean rank: 1220.5554034787567
Mean reciprocal rank: 0.26361229690715154
Test:
Number of data points: 20466
Hits @10: 0.39787940975276065
Hits @3: 0.2859865142187042
Hits @1: 0.1945177367340956
Mean rank: 1267.4001270399688
Mean reciprocal rank: 0.2611412057278709
Testing time:20.128154039382935
Iteration:7
Training Time:15.683048009872437
Loss:0.001945576097892776
Validation:
Number of data points: 17535
Hits @10: 0.40342172797262615
Hits @3: 0.3041345879669233
Hits @1: 0.21864841745081265
Mean rank: 1123.5063016823497
Mean reciprocal rank: 0.2808989989617476
Iteration:8
Training Time:15.716923952102661
Loss:0.001959667598178023
Validation:
Number of data points: 17535
Hits @10: 0.4130025662959795
Hits @3: 0.30983746792130024
Hits @1: 0.21973196464214428
Mean rank: 998.1832335329341
Mean reciprocal rank: 0.28527782807755847
Test:
Number of data points: 20466
Hits @10: 0.4092152838854686
Hits @3: 0.30641063226815207
Hits @1: 0.21665200820873645
Mean rank: 1026.0798885957197
Mean reciprocal rank: 0.28214815331213117
Testing time:19.67337465286255
Iteration:9
Training Time:15.772806406021118
Loss:0.001888223575613117
Validation:
Number of data points: 17535
Hits @10: 0.43256344453949247
Hits @3: 0.32301112061591103
Hits @1: 0.22914171656686627
Mean rank: 842.6813230681494
Mean reciprocal rank: 0.29712150233121837
Iteration:10
Training Time:15.741840362548828
Loss:0.001825630077645693
Validation:
Number of data points: 17535
Hits @10: 0.4418591388651269
Hits @3: 0.3293983461648132
Hits @1: 0.23279155973766752
Mean rank: 731.0519532363844
Mean reciprocal rank: 0.3024747325951413
Test:
Number of data points: 20466
Hits @10: 0.43550278510700674
Hits @3: 0.3244405355223297
Hits @1: 0.23082185087462131
Mean rank: 777.9734193296199
Mean reciprocal rank: 0.29897501104466473
Testing time:19.98979163169861
Iteration:11
Training Time:15.752880811691284
Loss:0.0018501243896922735
Validation:
Number of data points: 17535
Hits @10: 0.4163102366695181
Hits @3: 0.31776447105788425
Hits @1: 0.21665240946678072
Mean rank: 817.4383233532934
Mean reciprocal rank: 0.2869573138497088
Iteration:12
Training Time:15.758810758590698
Loss:0.0018200882321402227
Validation:
Number of data points: 17535
Hits @10: 0.44471057884231535
Hits @3: 0.3363558597091531
Hits @1: 0.23193612774451097
Mean rank: 629.6808098089535
Mean reciprocal rank: 0.3049422418567247
Test:
Number of data points: 20466
Hits @10: 0.4411218606469266
Hits @3: 0.3334799179126356
Hits @1: 0.22896511287012605
Mean rank: 678.1450698719829
Mean reciprocal rank: 0.30152728713108734
Testing time:19.593555688858032
Iteration:13
Training Time:15.75884461402893
Loss:0.0018177725286988465
Validation:
Number of data points: 17535
Hits @10: 0.4579982891360137
Hits @3: 0.3463358996293128
Hits @1: 0.24248645566010835
Mean rank: 569.2412888508696
Mean reciprocal rank: 0.3154083463419766
Iteration:14
Training Time:15.794747829437256
Loss:0.0018485438045152552
Validation:
Number of data points: 17535
Hits @10: 0.44733390362132874
Hits @3: 0.3371542629027659
Hits @1: 0.23638437410892502
Mean rank: 597.5493584260051
Mean reciprocal rank: 0.3080999029871035
Test:
Number of data points: 20466
Hits @10: 0.4415127528583993
Hits @3: 0.3316720414345744
Hits @1: 0.22969803576663736
Mean rank: 636.2441610475911
Mean reciprocal rank: 0.3018058804495888
Testing time:20.14001226425171
Iteration:15
Training Time:15.76677417755127
Loss:0.0017777800738607368
Validation:
Number of data points: 17535
Hits @10: 0.46073567151411465
Hits @3: 0.34941545480467634
Hits @1: 0.2440832620473339
Mean rank: 558.4011976047905
Mean reciprocal rank: 0.3179575281443938
Iteration:16
Training Time:15.749868869781494
Loss:0.001758754746478102
Validation:
Number of data points: 17535
Hits @10: 0.46535500427716
Hits @3: 0.3528371827773025
Hits @1: 0.24767607641859138
Mean rank: 507.493128029655
Mean reciprocal rank: 0.32214738012835575
Test:
Number of data points: 20466
Hits @10: 0.46198573243428126
Hits @3: 0.34843154500146584
Hits @1: 0.2415225251636861
Mean rank: 547.7602853513143
Mean reciprocal rank: 0.31682721095759164
Testing time:19.815083265304565
Iteration:17
Training Time:15.79474949836731
Loss:0.0017582185749819323
Validation:
Number of data points: 17535
Hits @10: 0.4760193897918449
Hits @3: 0.35739948674080413
Hits @1: 0.247276874821785
Mean rank: 468.5350441973196
Mean reciprocal rank: 0.32478897491347125
Iteration:18
Training Time:15.742887735366821
Loss:0.0017641492990126246
Validation:
Number of data points: 17535
Hits @10: 0.48092386655260905
Hits @3: 0.3639577986883376
Hits @1: 0.2515540347875677
Mean rank: 452.0329056173368
Mean reciprocal rank: 0.3296432950374527
Test:
Number of data points: 20466
Hits @10: 0.473223883514121
Hits @3: 0.3542949281735561
Hits @1: 0.2418645558487247
Mean rank: 477.3852731359328
Mean reciprocal rank: 0.3206487998552512
Testing time:20.20794367790222
Iteration:19
Training Time:16.188695907592773
Loss:0.0017494116016752916
Validation:
Number of data points: 17535
Hits @10: 0.4837182777302538
Hits @3: 0.36122041631023666
Hits @1: 0.25560307955517536
Mean rank: 450.6209295694326
Mean reciprocal rank: 0.3326438127094447
Iteration:20
Training Time:16.156779289245605
Loss:0.001734885105652709
Validation:
Number of data points: 17535
Hits @10: 0.47852865697177077
Hits @3: 0.35700028514399773
Hits @1: 0.2512118619903051
Mean rank: 485.56658112346736
Mean reciprocal rank: 0.3272698888023809
Test:
Number of data points: 20466
Hits @10: 0.4693149613993941
Hits @3: 0.35190071337828593
Hits @1: 0.24831427733802405
Mean rank: 516.2386885566306
Mean reciprocal rank: 0.3230685097873353
Testing time:20.458273887634277
Iteration:21
Training Time:16.19069242477417
Loss:0.0017357384846609545
Validation:
Number of data points: 17535
Hits @10: 0.48252067293983464
Hits @3: 0.36578272027373826
Hits @1: 0.2554890219560878
Mean rank: 431.7372112917023
Mean reciprocal rank: 0.3330191712180968
Iteration:22
Training Time:16.238561868667603
Loss:0.0017270188687739205
Validation:
Number of data points: 17535
Hits @10: 0.4866837753065298
Hits @3: 0.36732249786142
Hits @1: 0.2656971770744226
Mean rank: 441.4991730824066
Mean reciprocal rank: 0.3398467106667268
Test:
Number of data points: 20466
Hits @10: 0.48123717384931103
Hits @3: 0.36357861819603243
Hits @1: 0.2595524284178638
Mean rank: 482.95646437994725
Mean reciprocal rank: 0.33452027360183295
Testing time:20.413394451141357
Iteration:23
Training Time:16.1109037399292
Loss:0.0017635888628955063
Validation:
Number of data points: 17535
Hits @10: 0.49318505845451954
Hits @3: 0.37553464499572287
Hits @1: 0.2668947818648417
Mean rank: 396.157000285144
Mean reciprocal rank: 0.3436727945537293
Iteration:24
Training Time:16.178722143173218
Loss:0.0016794662906673469
Validation:
Number of data points: 17535
Hits @10: 0.48502994011976047
Hits @3: 0.36544054747647564
Hits @1: 0.25782720273738235
Mean rank: 486.1167379526661
Mean reciprocal rank: 0.33455186827505073
Test:
Number of data points: 20466
Hits @10: 0.48157920453434966
Hits @3: 0.3591810808169647
Hits @1: 0.25349359914003716
Mean rank: 510.9439069676537
Mean reciprocal rank: 0.3296847446838157
Testing time:20.286734104156494
Iteration:25
Training Time:16.22559642791748
Loss:0.0017164847697131336
Validation:
Number of data points: 17535
Hits @10: 0.5062446535500428
Hits @3: 0.38733960650128313
Hits @1: 0.27060165383518675
Mean rank: 362.1230111206159
Mean reciprocal rank: 0.3511290243173994
Iteration:26
Training Time:16.044081926345825
Loss:0.0017824369444422526
Validation:
Number of data points: 17535
Hits @10: 0.5083547191331622
Hits @3: 0.39013401767892786
Hits @1: 0.2746506986027944
Mean rank: 342.3730253778158
Mean reciprocal rank: 0.35479910795204306
Test:
Number of data points: 20466
Hits @10: 0.5024919378481384
Hits @3: 0.381559659923776
Hits @1: 0.27142577934134665
Mean rank: 371.92206586533763
Mean reciprocal rank: 0.34983849894319274
Testing time:20.691650390625
Iteration:27
Training Time:16.0989351272583
Loss:0.0016536356425167968
Validation:
Number of data points: 17535
Traceback (most recent call last):
  File "train.py", line 228, in <module>
    experiment.train_and_eval()
  File "train.py", line 159, in train_and_eval
    self.evaluate(model, d.valid_data)
  File "train.py", line 77, in evaluate
    target_value = predictions[j,e2_idx[j]].item()
KeyboardInterrupt
